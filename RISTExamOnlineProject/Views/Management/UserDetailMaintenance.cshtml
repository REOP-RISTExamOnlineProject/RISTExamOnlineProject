@using System.Security.Claims
@{
    ViewData["Title"] = "UserDetailMaintenance";
    Layout = "_Layout";
}


<h5 class="mb-0">
    <strong>User profile</strong>
</h5>
<span class="text-secondary">Employee Management <i class="fa fa-angle-right"></i> User profile</span>

<div class="row mt-3">
    <div class="col-sm-12">
        <!--User profile header-->
        <div class="mt-1 mb-3 button-container bg-white border shadow-sm">
            <div class="profile-bg p-5">
                <img src="@ViewBag.imgProfileUserDetail" height="125px" width="125px" class="rounded-circle shadow profile-img" id="imgUserProfile"/>
            </div>
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-5 offset-md-3 col-sm-12 offset-sm-0 col-12 bio-header">
                        <h3 class="mt-4" id="NameUserProfile">@ViewBag.NameEngUserDetail</h3>
                        @*<h3 class="mt-4">Wittaya Suttisak</h3>*@
                        <span class="text-muted mt-0" id="jobUserProfile">@ViewBag.JobTitleUserDetail</span>
                        @*  <span class="text-muted mt-0">System Development 2</span>*@
                    </div>
                    <div class="col-md-4 col-sm-2 col-12 px-5 text-right pt-4 bio-comment">
                        <div class="container">
                            <div class="col-sm-12">
                                <div class="mb-4">
                                    <div class="input-group mt-2">
                                        @Html.TextBox("strOPNo", null, new { @class = "form-control shadow-sm", placeholder = "Search Staff Code..", id = "strOPNo" })

                                        <div class="input-group-append">
                                            @*<button class="btn btn-theme" type="submit" id="button-addon2" formaction="@Url.Action("UserDetailMaintenance")">Search</button>*@

                                            <button class="btn btn-theme" type="button" onclick="" id="btnSearch" style="display:none;"   >Search</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--/User profile header-->
    </div>

</div>
<nav class="navbar navbar-expand-sm bg-dark text-white  navbar-dark mb-1" id="NavAdminBar" style="display:none;">
    <ul class="navbar-nav">
        <li class="nav-item mr-1">
            <button onclick="switchMenu('_partsUserInfo');" value="_partsAdditional" class="btn btn-dark nav-link">info</button>
        </li>
        <li class="nav-item mr-1">
            <button onclick="switchMenu('_partsUserDetail');" value="_partsAdditional" class="btn btn-dark nav-link">User detail</button>
        </li>
        <li class="nav-item mr-1">
            <button onclick="switchMenu('_partsAdditional');" value="_partsAdditional" class="btn btn-dark nav-link">Addition Department</button>
        </li>
        <li class="nav-item mr-1">
            <button onclick="switchMenu('_partsTrainning');" value="_partsAdditional" class="btn btn-dark nav-link">Training records</button>
        </li>
    </ul>
</nav>

<div class="form-row ">
    <div class="col">
        <div id="DestinationLayoutDiv">
            @await Html.PartialAsync("/Views/Shared/_partsUserManage/_partsUserInfo.cshtml")
        </div>
    </div>
</div>


@section scripts{


    <link href="~/lib/datatables/Css/jquery.dataTables.min.css" rel="stylesheet" />
    <script src="~/lib/datatables/Js/jquery.dataTables.min.js"></script>
    <script src="~/lib/CustomJS/ScriptUserManage/Additional.js"></script>
    <script src="~/lib/CustomJS/ScriptUserManage/UserManagemant.js"></script>

    <script type="text/javascript">

        $(document).ready(function () {
            $("#strOPNo").on("keyup", function (event) {
                if (event.keyCode == 13) {
                    $("#btnSearch").click();
                    return false;
                }
            });

            $("#btnSearch").on("click", function (event) {
                GetuserDetail();
            }); 
            if ("@User.FindFirst(claim => claim.Type == ClaimTypes.Role)?.Value" == "User") {
             
                $("#strOPNo").attr("readonly", "readonly")

                $("#strOPNo").val("@User.Identity.Name");
                GetuserDetail();
            } else if ("@User.FindFirst(claim => claim.Type == ClaimTypes.Role)?.Value" == "Admin") {
                $("#NavAdminBar").css("display", "block")
                $("#btnSearch").css("display", "block")
            }
        });

        function switchMenu(sss) {

            $.ajax({
                url: '@Url.Action("switchMenu")',
                data: { param: sss},
                type: 'GET',
                success: function (data) {

                    $('#DestinationLayoutDiv').html(data);
                    window.Getinitial();
                }
            });
        }

    </script>
}